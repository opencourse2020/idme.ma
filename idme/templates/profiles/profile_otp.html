{% extends "base.html" %}
{% load i18n %}
{% load static %}
{% load crispy_forms_tags %}
{% load socialaccount %}

{% block head_title %}

<title>{% trans "ID Verify" %}</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content={% trans "Streamline user onboarding and protect your business with our secure, AI-powered ID verification service, ensuring compliance and preventing fraud." %}>
<meta name="author" content="">
{% endblock head_title%}

{% block css %}

    {{ block.super }}

{% endblock css %}


{% block content_head %}


<h1 class="page-header">
    {% trans "Verify Your Identity" %}
</h1>
{% endblock content_head %}



{% block content_body %}
    <!-- Form Section -->
        <div class="row gx-4">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
            {% if request.user.picture %}
                <img class="img-fluid" src="{{ request.user.picture.url }}" style="border-radius: 50%; max-width: 200px; height: 200px" alt="">
            {% else %}
                <i class="fas fa-user-circle fa-5x mb-3 rounded-circle"></i>
            {% endif %}
        <h5 class="card-title text-center">{{ request.user.email }}</h5>
        <p>{% trans "Member since" %}:&nbsp;{{ request.user.date_joined }}</p>
                </div>
            <div class="card-body text-center">
        {% if not  request.user.mfa_enabled %}
        <h5 class="card-title">
            {% trans "Enable 2FA with Autheticator App." %}
        </h5>
            <div>
                <img src="{{ qr_code_data_uri }}" alt="{{ img_path }}" style="max-width: 200px; height: 200px">

                <form method="POST" action="{% url 'profiles:verify_mfa' %}" class="form text-center">
                    {% csrf_token %}
                    <div class="form-group text-">
                        <div class="mx-auto" style="width: 30%;">
                            <input type="text" id="otp_code" name="otp_code" maxlength="6" required
                                   class="form-control" placeholder="Enter your OTP code">
                        </div>
                    </div>
                    <input type="hidden" name="user_id" value="{{ request.user.id }}">
                    <button class="btn btn-primary" type="submit">{% trans "Verify" %}</button>
                </form>

                </div>

        {% else %}
        <a href="{% url 'profiles:disable_2fa' %}" class="btn btn-success" disabled>
            {% trans "Disable 2FA" %}
        </a>
        {% endif %}
                </div>
            <div class="card-arrow">
                        <div class="card-arrow-top-left"></div>
                        <div class="card-arrow-top-right"></div>
                        <div class="card-arrow-bottom-left"></div>
                        <div class="card-arrow-bottom-right"></div>
                    </div>
            </div>
        </div>
        </div>
{% endblock content_body %}

{% block js %}
  {{ block.super }}

<script>
function goBack() {
  window.history.back();
}
</script>
{% endblock js %}
